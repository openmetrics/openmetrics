<%#*we are building a nested list of running services here%>
<%#*a collectd plugin will be installed if it is dropped to a sublist%>

<%#** html #collectd_plugins_list li { height: 1%; }%>

<style type="text/css">
/* pool of collectd plugins as a list*/
li span.ui-icon { float: left; }
.left-floating { float: left; }
li span.ui-icon.right-floating { float: right; cursor: pointer; }
li.ui-draggable-dragging {  width: 380px;  }
li.placeholder span.ui-icon { float: none; display: inline-block; }
li.placeholder {text-align: center;}

div#collectd_plugins_list_container { width: 400px; float:left; }
div#collectd_plugins_list_container ul { padding: 0px; margin: 10px; }
div#collectd_plugins_list_container ul li { margin: 5px 0px; cursor: move; list-style-type: none; }

div#enabled_collectd_plugins_lists_container { width: 400px; float:left; margin-left: 30px; }
div#enabled_collectd_plugins_lists_container ul { margin: 10px 0px; border: 2px solid orange; min-height: 30px; }
div#enabled_collectd_plugins_lists_container ul li { margin: 5px 10px; list-style-type: none;}


</style>

<div class="row">
  <div class="col-md-4">
    <h3>Available Collectd Plugins</h3>
    <%#*list of all available collectd_plugins%>
    <div id="collectd_plugins_list_container">
      <ul id="collectd_plugins_list" class="list-group">
        <% @collectd_plugins.each do |plugin|  %>
            <li class="collectd-plugin list-group-item" data-collectd_plugin="<%= plugin.id %>">
              <%= badge "CP-#{plugin.id}", 'primary' %>
              <%= plugin.name %>
              <span class="pull-right fa fa-arrows"></span>
            </li>
        <% end %>
      </ul>
    </div>

  </div>


  <div class="col-md-8">
    <%#*every running service should provide a drop-zone for the collectd_plugins%>
    <div id="enabled_collectd_plugins_lists_container">
      <h3>Running Services</h3>
      <% @system.running_services.each do |rs| %>
          <h4><%= rs.service.name %></h4>

          <ul class="list-group" data-running_service="<%= rs.id %>">
            <% rcps = RunningCollectdPlugin.where(running_service_id: rs.id) %>
            <% rcps.each do |rcp| %>
                <li class="enabled list-group-item" data-running_collectd_plugin="<%= rcp.id %>">
                  <%= badge "CP-#{rcp.collectd_plugin.id}", 'primary' unless rcp.collectd_plugin.nil? %>
                  <%= rcp.collectd_plugin.name unless rcp.collectd_plugin.nil? %>
                  <span class="ui-icon ui-icon-close right-floating" title="Remove"></span>
                </li>
            <% end %>
            <li class="ui-state-highlight placeholder"><span class="ui-icon ui-icon-plus" title="Drop here"></span>Drop here</li>
          </ul>
      <% end %>
    </div>
  </div>

</div>
